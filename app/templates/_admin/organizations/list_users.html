{% extends "../base.html" %}

{% block sidebar %}
{% with group=1 page=1 %}
{{ block.super }}
{% endwith %}
{% endblock %}

{% block content %}
<div class="content p-3"> 
  <h4>List of Users From Organization: {{organization.name}}</h4>
  <br>
  <table id="table" class="display mt-2">
    <thead>
      <tr>
        <th style="width: 30%;">Full Name</th>
        <th style="width: 30%;">Email</th>
        <th style="width: 20%;">Role</th>
        <th style="width: 20%;">Status</th>        
      </tr>
    </thead>
  </table>
  <a href="/_admin" class="btn btn-secondary">Back</a>
</div>
<script>
  $(document).ready(function() {
    $('#table').DataTable({
      "ordering": false,
      "processing": true,
      "serverSide": true,
      "ajax": {
        "url": "/api/user/search",
        "data": function(data) {
          data.organizationId = '{{organization.id}}';
        }
      },
      "columns": [
        { "data": "fullname",
          render: function(data, type, row) {
            var html = '';
            if(row.profilePicture) {
              html += `<img class="img-profile rounded-circle mr-2" src="/${ row.profilePicture }">`;
            }else {
              html += `<img class="img-profile rounded-circle mr-2" src="/static/img/user.png">`;
            }
            html += `<span>${data}</span>`;
            return html;
          } 
        },
        { "data": "email" },
        { "data": "role"},
        { "data": "status", "render": function(data, type, row) {
            if(data == 0) return "Pending";
            return row.is_active? "Active": "Inactive";
          } 
        }   
      ],
    })
  });  
</script>
{% endblock %}